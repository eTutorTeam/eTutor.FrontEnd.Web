<div class="modal" [ngClass]="{'is-active': isVisible}">
    <div class="modal-background" (click)="closeModal()"></div>
    <div class="modal-card">
        <header class="modal-card-head">
            <p class="modal-card-title">Cambiar Contraseña</p>
        </header>
        <section class="modal-card-body">
            <form [formGroup]="changeForm" (submit)="submitForm()">
                <app-text-input-form-control label="Contraseña Actual"
                                             placeholder="Ingrese su contraseña actual"
                                             icon="fas fa-lock"
                                             [control]="currentPassword"
                                             type="password"
                                             formControlName="currentPassword"
                ></app-text-input-form-control>
                <br>
                <app-text-input-form-control label="Contraseña Nueva"
                                             placeholder="Ingrese su nueva contraseña"
                                             icon="fas fa-lock"
                                             [control]="newPassword"
                                             type="password"
                                             formControlName="newPassword"
                ></app-text-input-form-control>
                <br>
                <app-text-input-form-control label="Confirmar Contraseña Nueva"
                                             placeholder="Ingrese su nueva contraseña nuevamente"
                                             icon="fas fa-lock"
                                             [control]="newPasswordConfirm"
                                             type="password"
                                             formControlName="newPasswordConfirm"
                ></app-text-input-form-control>
                <div class="help-block" *ngIf="(!oldAndNewPasswordAreDifferent || !passwordsMatch) && changeForm.touched && changeForm.valid">
                    <p class="help is-danger" *ngIf="!oldAndNewPasswordAreDifferent && (newPassword.touched && newPassword.dirty)">Debe de ingresar una contraseña diferente a la actual para hacer el cambio.</p>
                    <p class="help is-danger" *ngIf="!passwordsMatch && newPasswordConfirm.touched">El campo de confirmar contraseña, debe de ser igual al anterior.</p>
                </div>
            </form>
        </section>
        <footer class="modal-card-foot">
            <button class="button is-success" [disabled]="!formIsValid" (click)="submitForm()">Cambiar</button>
            <button class="button" (click)="closeModal()">Cancelar</button>
        </footer>
    </div>
</div>

<ngx-loading [show]="isLoading"></ngx-loading>
